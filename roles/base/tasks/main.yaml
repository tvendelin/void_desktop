---
- name: 'xbps upgrade'
  xbps: name=xbps upgrade=yes

- name: 'xbps extra repos'
  xbps:
    upgrade: yes
    name:
      - void-repo-nonfree
      - xtools

- name: 'xbps upgrade'
  xbps:
    upgrade: yes

- name: 'install packages'
  xbps:
    state: latest
    name: '{{item}}'
  loop:
    - rxvt-unicode
    - urxvt-perls
    - unzip
    - xorg
    - alsa-utils
    - base-devel
    - libX11-devel
    - libXft-devel
    - libXinerama-devel
    #  - google-fonts-ttf
    - xkblayout-state

- name: 'install davinci dependencies'
  xbps:
    state: latest
    upgrade: yes
    name:
      - nvidia
      - nvidia-opencl
      - libopencv
      - xcb-util
      - xcb-util-wm
      - xcb-util-image
      - xcb-util-keysyms
      - xcb-util-renderutil
      - libxkbcommon-x11
      - glu

- name: 'Suckless dir'
  file:
    path: '~/suckless'
    state: directory
  become_user: void

- name: 'download suckless things'
  get_url:
    url: '{{item}}'
    dest: '~/suckless/'
  loop: '{{ suckless_software }}'
  become_user: void

- name: 'Find tars'
  find:
    path: '~/suckless'
    patterns: '*.tar.gz'
  register: tars
  become_user: void

- name: 'Unpack suckless'
  unarchive:
    src: "{{item['path']}}"
    remote_src: yes
    dest: '~/suckless/'
  loop: "{{tars['files']}}"
  become_user: void
